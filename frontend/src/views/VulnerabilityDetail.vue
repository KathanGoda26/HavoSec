<template>
  <div class="vulnerability-detail-page">
    <div class="container">
      <!-- Back Button -->
      <button @click="$router.push('/')" class="back-button">
        <ArrowLeftIcon class="w-5 h-5" />
        Back to Home
      </button>

      <!-- Vulnerability Header -->
      <div class="vulnerability-header">
        <div class="vulnerability-badge" :style="{ background: vulnerability?.color }">
          Vulnerability Analysis
        </div>
        <h1 class="vulnerability-title">{{ vulnerability?.title }}</h1>
        <div class="vulnerability-meta">
          <span class="meta-item">
            <ClockIcon class="w-5 h-5" />
            Detection Time: {{ vulnerability?.detectionTime }}
          </span>
          <span class="meta-item">
            <ShieldCheckIcon class="w-5 h-5" />
            Severity: {{ vulnerability?.severity }}
          </span>
        </div>
      </div>

      <!-- Vulnerability Content -->
      <div class="vulnerability-content glass">
        <section class="content-section">
          <h2 class="section-heading">Overview</h2>
          <p class="section-text">{{ vulnerability?.fullDescription }}</p>
        </section>

        <section class="content-section">
          <h2 class="section-heading">How Our Agent Detects This Vulnerability</h2>
          <div class="workflow-steps">
            <div 
              v-for="(step, index) in vulnerability?.detectionWorkflow" 
              :key="index"
              class="workflow-step"
            >
              <div class="step-number">{{ index + 1 }}</div>
              <div class="step-content">
                <h3 class="step-title">{{ step.title }}</h3>
                <p class="step-description">{{ step.description }}</p>
              </div>
            </div>
          </div>
        </section>

        <section class="content-section">
          <h2 class="section-heading">Defense Mechanisms</h2>
          <div class="defense-grid">
            <div 
              v-for="(defense, index) in vulnerability?.defenseMechanisms" 
              :key="index"
              class="defense-card"
            >
              <div class="defense-icon">
                <BoltIcon class="w-6 h-6" />
              </div>
              <h3 class="defense-title">{{ defense.title }}</h3>
              <p class="defense-description">{{ defense.description }}</p>
            </div>
          </div>
        </section>

        <section class="content-section">
          <h2 class="section-heading">Real-World Impact</h2>
          <div class="impact-stats">
            <div class="impact-stat">
              <div class="stat-value">{{ vulnerability?.impact?.attacksBlocked }}</div>
              <div class="stat-label">Attacks Blocked</div>
            </div>
            <div class="impact-stat">
              <div class="stat-value">{{ vulnerability?.impact?.responseTime }}</div>
              <div class="stat-label">Avg Response Time</div>
            </div>
            <div class="impact-stat">
              <div class="stat-value">{{ vulnerability?.impact?.successRate }}</div>
              <div class="stat-label">Success Rate</div>
            </div>
          </div>
        </section>

        <section class="content-section">
          <h2 class="section-heading">Technical Details</h2>
          <div class="technical-details">
            <div class="detail-item">
              <strong>Attack Vector:</strong> {{ vulnerability?.technicalDetails?.attackVector }}
            </div>
            <div class="detail-item">
              <strong>Common Targets:</strong> {{ vulnerability?.technicalDetails?.commonTargets }}
            </div>
            <div class="detail-item">
              <strong>Prevention Methods:</strong> {{ vulnerability?.technicalDetails?.prevention }}
            </div>
          </div>
        </section>

        <section class="content-section">
          <h2 class="section-heading">Step-by-Step: Finding This Vulnerability</h2>
          <div class="steps-container">
            <div 
              v-for="(step, index) in vulnerability?.vulnerabilityFindingSteps" 
              :key="index"
              class="finding-step"
            >
              <div class="step-header">
                <div class="step-badge">Step {{ index + 1 }}</div>
                <h3 class="finding-step-title">{{ step.title }}</h3>
              </div>
              <p class="finding-step-description">{{ step.description }}</p>
              <div v-if="step.command" class="command-box">
                <div class="command-label">Command:</div>
                <code class="command-text">{{ step.command }}</code>
              </div>
            </div>
          </div>
        </section>

        <section class="content-section">
          <h2 class="section-heading">Code Examples</h2>
          
          <div class="code-section">
            <h3 class="code-section-title">Vulnerable Code</h3>
            <div class="code-block vulnerable">
              <div class="code-header">
                <span class="code-language">{{ vulnerability?.codeExamples?.vulnerable?.language }}</span>
                <span class="code-badge danger">‚ö†Ô∏è Vulnerable</span>
              </div>
              <pre class="code-content"><code>{{ vulnerability?.codeExamples?.vulnerable?.code }}</code></pre>
            </div>
          </div>

          <div class="code-section">
            <h3 class="code-section-title">Secure Code</h3>
            <div class="code-block secure">
              <div class="code-header">
                <span class="code-language">{{ vulnerability?.codeExamples?.secure?.language }}</span>
                <span class="code-badge safe">‚úì Secure</span>
              </div>
              <pre class="code-content"><code>{{ vulnerability?.codeExamples?.secure?.code }}</code></pre>
            </div>
          </div>

          <div class="code-section">
            <h3 class="code-section-title">Attack Example</h3>
            <div class="code-block attack">
              <div class="code-header">
                <span class="code-language">{{ vulnerability?.codeExamples?.attack?.language }}</span>
                <span class="code-badge attack">üéØ Attack Pattern</span>
              </div>
              <pre class="code-content"><code>{{ vulnerability?.codeExamples?.attack?.code }}</code></pre>
            </div>
          </div>
        </section>
      </div>

      <!-- CTA Section -->
      <div class="cta-section glass">
        <h2 class="cta-title">Want to see HavoSec in action?</h2>
        <p class="cta-description">
          Schedule a personalized demo to see how our platform can protect your organization.
        </p>
        <LuxuryButton @click="$router.push('/book-demo')" size="lg">
          Schedule Demo
        </LuxuryButton>
      </div>
    </div>
  </div>
</template>

<script setup>
import { ref, computed, onMounted } from 'vue'
import { useRoute, useRouter } from 'vue-router'
import { 
  ArrowLeftIcon, 
  ClockIcon, 
  ShieldCheckIcon,
  BoltIcon 
} from '@heroicons/vue/24/outline'
import LuxuryButton from '@/components/LuxuryButton.vue'

const route = useRoute()
const router = useRouter()

// Vulnerability database
const vulnerabilities = [
  {
    id: '1',
    title: 'SQL Injection Detection & Prevention',
    shortDescription: 'AI-powered detection of SQL injection attempts with real-time query analysis and automatic blocking.',
    fullDescription: 'SQL injection remains one of the most critical web application vulnerabilities. Our advanced AI agents continuously monitor database queries, detecting malicious patterns and anomalies in real-time. The system uses machine learning models trained on millions of attack patterns to identify both known and zero-day SQL injection attempts.',
    color: '#673ee6',
    severity: 'Critical',
    detectionTime: '< 10ms',
    detectionWorkflow: [
      { title: 'Query Interception', description: 'All database queries are intercepted at the application layer before execution.' },
      { title: 'Pattern Analysis', description: 'AI models analyze query structure for known SQL injection patterns and suspicious syntax.' },
      { title: 'Behavioral Analysis', description: 'Machine learning evaluates query behavior against normal application patterns.' },
      { title: 'Threat Scoring', description: 'Each query receives a threat score based on multiple risk factors.' },
      { title: 'Automated Response', description: 'High-risk queries are blocked instantly, and security teams are alerted.' }
    ],
    defenseMechanisms: [
      { title: 'Real-time Blocking', description: 'Malicious queries are blocked before reaching the database.' },
      { title: 'Parameterized Query Enforcement', description: 'System enforces prepared statements and parameterized queries.' },
      { title: 'Input Sanitization', description: 'Automatic sanitization of user inputs across all entry points.' }
    ],
    impact: {
      attacksBlocked: '1.2M+',
      responseTime: '8ms',
      successRate: '99.97%'
    },
    technicalDetails: {
      attackVector: 'Web application input fields, API parameters, URL parameters',
      commonTargets: 'Login forms, search bars, user profile updates, API endpoints',
      prevention: 'Prepared statements, input validation, least privilege database access, WAF integration'
    },
    vulnerabilityFindingSteps: [
      { title: 'Identify Input Points', description: 'Locate all user input fields, URL parameters, and API endpoints that interact with the database.', command: 'grep -r "query\\|execute\\|SELECT" ./src' },
      { title: 'Test for SQL Injection', description: 'Input malicious SQL payloads to test if the application is vulnerable.', command: "sqlmap -u 'http://target.com/page?id=1' --batch" },
      { title: 'Analyze Query Structure', description: 'Examine how user input is incorporated into SQL queries without proper sanitization.' },
      { title: 'Check Error Messages', description: 'Look for detailed database error messages that reveal schema information.', command: "curl 'http://target.com/login' -d \"username=admin'--\"" },
      { title: 'Verify Impact', description: 'Confirm data extraction, modification, or authentication bypass is possible through the vulnerability.' }
    ],
    codeExamples: {
      vulnerable: {
        language: 'Python (Vulnerable)',
        code: `# VULNERABLE CODE - DO NOT USE
def get_user(username):
    query = "SELECT * FROM users WHERE username = '" + username + "'"
    cursor.execute(query)
    return cursor.fetchone()

# Attacker input: admin' OR '1'='1' --
# Resulting query: SELECT * FROM users WHERE username = 'admin' OR '1'='1' --'`
      },
      secure: {
        language: 'Python (Secure)',
        code: `# SECURE CODE - Use Parameterized Queries
def get_user(username):
    query = "SELECT * FROM users WHERE username = %s"
    cursor.execute(query, (username,))
    return cursor.fetchone()

# Using ORM (e.g., SQLAlchemy)
user = session.query(User).filter(User.username == username).first()`
      },
      attack: {
        language: 'SQL Injection Payload',
        code: `# Authentication Bypass
username: admin' OR '1'='1' --
password: anything

# Data Extraction (Union-based)
id: 1' UNION SELECT username, password FROM users --

# Blind SQL Injection (Time-based)
id: 1' AND IF(1=1, SLEEP(5), 0) --`
      }
    }
  },
  {
    id: '2',
    title: 'Cross-Site Scripting (XSS) Protection',
    shortDescription: 'Multi-layered XSS detection using content analysis and browser-level protection mechanisms.',
    fullDescription: 'Cross-Site Scripting attacks exploit trust relationships between users and web applications. Our comprehensive XSS protection analyzes all user-generated content, implementing multiple layers of defense including content security policies, input/output encoding, and real-time script analysis.',
    color: '#00b090',
    severity: 'High',
    detectionTime: '< 15ms',
    detectionWorkflow: [
      { title: 'Content Scanning', description: 'All user inputs are scanned for script tags and malicious code patterns.' },
      { title: 'Context-Aware Analysis', description: 'System understands the context where data will be rendered to detect context-specific attacks.' },
      { title: 'DOM Monitoring', description: 'Client-side monitoring of DOM modifications to catch dynamic XSS attempts.' },
      { title: 'CSP Enforcement', description: 'Content Security Policy rules are dynamically enforced and monitored.' }
    ],
    defenseMechanisms: [
      { title: 'Output Encoding', description: 'Automatic encoding of all user-generated content before rendering.' },
      { title: 'CSP Headers', description: 'Strict Content Security Policy headers prevent unauthorized script execution.' },
      { title: 'Script Integrity Checks', description: 'All scripts are validated against known safe sources.' }
    ],
    impact: {
      attacksBlocked: '850K+',
      responseTime: '12ms',
      successRate: '99.93%'
    },
    technicalDetails: {
      attackVector: 'User input fields, URL parameters, cookies, HTTP headers',
      commonTargets: 'Comment sections, user profiles, forum posts, messaging features',
      prevention: 'Output encoding, CSP implementation, HTTPOnly cookies, input validation'
    }
  },
  {
    id: '3',
    title: 'DDoS Attack Mitigation',
    shortDescription: 'Distributed denial-of-service protection with intelligent traffic analysis and rate limiting.',
    fullDescription: 'Our DDoS protection system uses advanced traffic analysis and machine learning to distinguish between legitimate traffic spikes and coordinated attacks. The system can handle millions of requests per second while maintaining service availability for legitimate users.',
    color: '#8b5cf6',
    severity: 'Critical',
    detectionTime: '< 50ms',
    detectionWorkflow: [
      { title: 'Traffic Baseline', description: 'Continuous learning of normal traffic patterns and user behavior.' },
      { title: 'Anomaly Detection', description: 'Real-time identification of traffic anomalies and suspicious patterns.' },
      { title: 'Bot Detection', description: 'Advanced bot detection algorithms identify automated attack tools.' },
      { title: 'Geographic Analysis', description: 'Traffic origin analysis to identify coordinated attacks from multiple locations.' },
      { title: 'Adaptive Response', description: 'Dynamic rate limiting and traffic shaping based on threat level.' }
    ],
    defenseMechanisms: [
      { title: 'Rate Limiting', description: 'Intelligent rate limiting at multiple layers (IP, user, endpoint).' },
      { title: 'Traffic Filtering', description: 'Real-time filtering of malicious traffic at network edge.' },
      { title: 'Load Distribution', description: 'Automatic traffic distribution across infrastructure during attacks.' }
    ],
    impact: {
      attacksBlocked: '5.2M+',
      responseTime: '45ms',
      successRate: '99.99%'
    },
    technicalDetails: {
      attackVector: 'HTTP floods, UDP floods, SYN floods, application-layer attacks',
      commonTargets: 'Web servers, API endpoints, DNS servers, network infrastructure',
      prevention: 'Rate limiting, traffic filtering, CDN integration, auto-scaling'
    }
  },
  {
    id: '4',
    title: 'Zero-Day Exploit Detection',
    shortDescription: 'Machine learning-based detection of previously unknown vulnerabilities and attack patterns.',
    fullDescription: 'Zero-day exploits represent the most challenging security threats. Our AI-powered system uses behavioral analysis and anomaly detection to identify attacks that exploit previously unknown vulnerabilities, providing protection even before patches are available.',
    color: '#34d399',
    severity: 'Critical',
    detectionTime: '< 100ms',
    detectionWorkflow: [
      { title: 'Behavioral Baseline', description: 'Establish normal application and system behavior patterns.' },
      { title: 'Anomaly Scoring', description: 'Real-time scoring of unusual behaviors and access patterns.' },
      { title: 'Exploit Signature Learning', description: 'Machine learning continuously identifies new exploit patterns.' },
      { title: 'Sandbox Analysis', description: 'Suspicious code is executed in isolated sandboxes for analysis.' },
      { title: 'Threat Intelligence', description: 'Integration with global threat intelligence feeds for early warnings.' }
    ],
    defenseMechanisms: [
      { title: 'Virtual Patching', description: 'Temporary protection rules deployed while official patches are prepared.' },
      { title: 'Behavioral Blocking', description: 'Block suspicious behaviors even without known signatures.' },
      { title: 'Micro-segmentation', description: 'Network segmentation limits exploit spread.' }
    ],
    impact: {
      attacksBlocked: '45K+',
      responseTime: '85ms',
      successRate: '98.5%'
    },
    technicalDetails: {
      attackVector: 'Unknown software vulnerabilities, unpatched systems',
      commonTargets: 'Operating systems, applications, firmware, network devices',
      prevention: 'Behavioral analysis, sandboxing, threat intelligence, defense-in-depth'
    }
  },
  {
    id: '5',
    title: 'Ransomware Defense System',
    shortDescription: 'Multi-stage ransomware detection and prevention with automated backup protection.',
    fullDescription: 'Ransomware attacks can cripple organizations by encrypting critical data. Our defense system monitors file system activities, process behaviors, and network communications to detect ransomware at the earliest stages, before encryption begins.',
    color: '#f59e0b',
    severity: 'Critical',
    detectionTime: '< 200ms',
    detectionWorkflow: [
      { title: 'File Activity Monitoring', description: 'Real-time monitoring of file system operations and patterns.' },
      { title: 'Process Behavior Analysis', description: 'Analysis of process behaviors for encryption activities.' },
      { title: 'Network Communication Tracking', description: 'Monitor for C&C server communications and data exfiltration.' },
      { title: 'Entropy Analysis', description: 'File entropy analysis to detect encryption activities.' },
      { title: 'Immediate Isolation', description: 'Infected systems are immediately isolated from the network.' }
    ],
    defenseMechanisms: [
      { title: 'Process Termination', description: 'Suspicious processes are immediately terminated.' },
      { title: 'Automatic Rollback', description: 'Files are automatically restored from shadow copies.' },
      { title: 'Network Isolation', description: 'Infected systems are quarantined to prevent spread.' }
    ],
    impact: {
      attacksBlocked: '325K+',
      responseTime: '180ms',
      successRate: '99.8%'
    },
    technicalDetails: {
      attackVector: 'Email attachments, malicious downloads, exploit kits, compromised credentials',
      commonTargets: 'File servers, databases, backups, user workstations',
      prevention: 'Email filtering, endpoint protection, backup isolation, user training'
    }
  },
  {
    id: '6',
    title: 'API Authentication Bypass Prevention',
    shortDescription: 'Advanced authentication and authorization monitoring for API endpoints.',
    fullDescription: 'API security is critical in modern applications. Our system monitors authentication flows, token usage, and authorization patterns to detect and prevent authentication bypass attempts, ensuring only authorized users access protected resources.',
    color: '#ef4444',
    severity: 'High',
    detectionTime: '< 20ms',
    detectionWorkflow: [
      { title: 'Token Validation', description: 'Comprehensive validation of JWT tokens and session credentials.' },
      { title: 'Authorization Checks', description: 'Verify user permissions for each API endpoint access.' },
      { title: 'Pattern Recognition', description: 'Identify suspicious authentication patterns and replay attacks.' },
      { title: 'Rate Limiting', description: 'Prevent brute-force authentication attempts.' }
    ],
    defenseMechanisms: [
      { title: 'Multi-Factor Authentication', description: 'Enforce MFA for sensitive operations.' },
      { title: 'Token Rotation', description: 'Automatic rotation of authentication tokens.' },
      { title: 'IP Whitelisting', description: 'Restrict API access to authorized IP ranges.' }
    ],
    impact: {
      attacksBlocked: '620K+',
      responseTime: '15ms',
      successRate: '99.95%'
    },
    technicalDetails: {
      attackVector: 'Token manipulation, credential stuffing, session hijacking',
      commonTargets: 'REST APIs, GraphQL endpoints, microservices',
      prevention: 'Strong authentication, JWT validation, RBAC, API gateways'
    }
  },
  {
    id: '7',
    title: 'Privilege Escalation Detection',
    shortDescription: 'Monitor and prevent unauthorized privilege elevation attempts across systems.',
    fullDescription: 'Privilege escalation allows attackers to gain elevated access beyond their authorized level. Our system monitors all privilege changes, command executions, and system calls to detect both vertical and horizontal privilege escalation attempts.',
    color: '#10b981',
    severity: 'Critical',
    detectionTime: '< 30ms',
    detectionWorkflow: [
      { title: 'Permission Monitoring', description: 'Track all permission changes and privilege requests.' },
      { title: 'Command Analysis', description: 'Analyze executed commands for privilege escalation patterns.' },
      { title: 'Baseline Comparison', description: 'Compare activities against expected user behavior baselines.' },
      { title: 'Exploit Detection', description: 'Identify known privilege escalation exploits and techniques.' }
    ],
    defenseMechanisms: [
      { title: 'Least Privilege Enforcement', description: 'Automatically enforce principle of least privilege.' },
      { title: 'Privilege Rollback', description: 'Immediately revoke unauthorized privilege changes.' },
      { title: 'Alert & Audit', description: 'Comprehensive logging and alerting of privilege changes.' }
    ],
    impact: {
      attacksBlocked: '180K+',
      responseTime: '25ms',
      successRate: '99.6%'
    },
    technicalDetails: {
      attackVector: 'Kernel exploits, misconfigurations, sudo vulnerabilities, SUID binaries',
      commonTargets: 'Linux/Unix systems, Windows servers, cloud environments',
      prevention: 'Regular patching, access control, security monitoring, configuration hardening'
    }
  },
  {
    id: '8',
    title: 'Phishing Detection & Response',
    shortDescription: 'AI-powered email and website analysis to identify and block phishing attempts.',
    fullDescription: 'Phishing remains the primary vector for initial compromise. Our system analyzes email content, sender reputation, URLs, and user behavior to identify sophisticated phishing campaigns, including spear-phishing and CEO fraud attempts.',
    color: '#6366f1',
    severity: 'High',
    detectionTime: '< 500ms',
    detectionWorkflow: [
      { title: 'Email Analysis', description: 'Deep analysis of email headers, content, and attachments.' },
      { title: 'URL Inspection', description: 'Real-time analysis of embedded URLs and landing pages.' },
      { title: 'Sender Verification', description: 'Verify sender authenticity using SPF, DKIM, and DMARC.' },
      { title: 'Content Comparison', description: 'Compare with known legitimate communications for brand impersonation.' }
    ],
    defenseMechanisms: [
      { title: 'Email Quarantine', description: 'Suspicious emails are automatically quarantined.' },
      { title: 'URL Rewriting', description: 'URLs are rewritten to route through security scanner.' },
      { title: 'User Alerts', description: 'Visual warnings for suspected phishing attempts.' }
    ],
    impact: {
      attacksBlocked: '2.8M+',
      responseTime: '450ms',
      successRate: '99.1%'
    },
    technicalDetails: {
      attackVector: 'Email, SMS, social media, malicious websites',
      commonTargets: 'Employees, executives, finance departments',
      prevention: 'Email filtering, user training, MFA, anti-phishing tools'
    }
  },
  {
    id: '9',
    title: 'Man-in-the-Middle Attack Prevention',
    shortDescription: 'Secure communication monitoring and encryption verification to prevent MITM attacks.',
    fullDescription: 'Man-in-the-Middle attacks intercept communications between parties. Our system ensures end-to-end encryption, validates certificates, and monitors for suspicious proxy behaviors or traffic interception attempts.',
    color: '#ec4899',
    severity: 'High',
    detectionTime: '< 40ms',
    detectionWorkflow: [
      { title: 'Certificate Validation', description: 'Continuous validation of SSL/TLS certificates.' },
      { title: 'Encryption Verification', description: 'Ensure strong encryption protocols are in use.' },
      { title: 'Network Monitoring', description: 'Monitor for ARP spoofing and DNS hijacking.' },
      { title: 'Traffic Analysis', description: 'Analyze traffic patterns for proxy indicators.' }
    ],
    defenseMechanisms: [
      { title: 'Certificate Pinning', description: 'Enforce certificate pinning for critical connections.' },
      { title: 'HSTS Enforcement', description: 'Strict Transport Security prevents protocol downgrade.' },
      { title: 'VPN Protection', description: 'Encrypted tunnels for sensitive communications.' }
    ],
    impact: {
      attacksBlocked: '95K+',
      responseTime: '35ms',
      successRate: '99.7%'
    },
    technicalDetails: {
      attackVector: 'ARP spoofing, DNS hijacking, rogue access points, SSL stripping',
      commonTargets: 'Public WiFi users, remote workers, mobile devices',
      prevention: 'HTTPS everywhere, certificate pinning, VPN usage, network security'
    }
  },
  {
    id: '10',
    title: 'Insider Threat Detection',
    shortDescription: 'Behavioral analytics to identify malicious or negligent insider activities.',
    fullDescription: 'Insider threats are difficult to detect as they involve authorized users. Our system uses behavioral analytics, data access patterns, and anomaly detection to identify suspicious activities by employees or contractors before damage occurs.',
    color: '#14b8a6',
    severity: 'High',
    detectionTime: '< 5min',
    detectionWorkflow: [
      { title: 'User Profiling', description: 'Build behavioral profiles for each user over time.' },
      { title: 'Anomaly Detection', description: 'Identify deviations from normal behavior patterns.' },
      { title: 'Data Access Monitoring', description: 'Track sensitive data access and exfiltration attempts.' },
      { title: 'Activity Correlation', description: 'Correlate multiple suspicious activities for threat scoring.' }
    ],
    defenseMechanisms: [
      { title: 'Access Restrictions', description: 'Automatically restrict access for high-risk users.' },
      { title: 'Data Loss Prevention', description: 'Block unauthorized data transfers and downloads.' },
      { title: 'Session Recording', description: 'Record sessions of users with elevated privileges.' }
    ],
    impact: {
      attacksBlocked: '28K+',
      responseTime: '4min',
      successRate: '97.3%'
    },
    technicalDetails: {
      attackVector: 'Authorized access, credential abuse, data exfiltration',
      commonTargets: 'Sensitive data, intellectual property, customer information',
      prevention: 'User behavior analytics, access controls, DLP, employee monitoring'
    }
  },
  {
    id: '11',
    title: 'Cryptojacking Prevention',
    shortDescription: 'Detect and block unauthorized cryptocurrency mining activities on systems.',
    fullDescription: 'Cryptojacking silently uses computing resources for cryptocurrency mining. Our system monitors CPU/GPU usage patterns, network connections, and process behaviors to detect and block mining scripts and software.',
    color: '#f97316',
    severity: 'Medium',
    detectionTime: '< 2min',
    detectionWorkflow: [
      { title: 'Resource Monitoring', description: 'Track CPU, GPU, and memory usage patterns.' },
      { title: 'Process Analysis', description: 'Identify mining-related processes and scripts.' },
      { title: 'Network Detection', description: 'Monitor connections to known mining pools.' },
      { title: 'Script Scanning', description: 'Scan web pages for embedded mining scripts.' }
    ],
    defenseMechanisms: [
      { title: 'Script Blocking', description: 'Block known mining scripts and domains.' },
      { title: 'Process Termination', description: 'Kill unauthorized mining processes.' },
      { title: 'Browser Protection', description: 'Browser extensions to prevent in-browser mining.' }
    ],
    impact: {
      attacksBlocked: '420K+',
      responseTime: '90sec',
      successRate: '98.9%'
    },
    technicalDetails: {
      attackVector: 'Web-based scripts, malware, compromised software',
      commonTargets: 'Web servers, end-user devices, cloud instances',
      prevention: 'Ad blockers, anti-malware, resource monitoring, script blockers'
    }
  },
  {
    id: '12',
    title: 'Remote Code Execution (RCE) Defense',
    shortDescription: 'Prevent unauthorized code execution through input validation and sandboxing.',
    fullDescription: 'Remote Code Execution vulnerabilities allow attackers to run arbitrary code on systems. Our defense system validates all inputs, sandboxes execution environments, and monitors for code injection attempts across applications.',
    color: '#8b5cf6',
    severity: 'Critical',
    detectionTime: '< 25ms',
    detectionWorkflow: [
      { title: 'Input Sanitization', description: 'Validate and sanitize all user inputs and uploads.' },
      { title: 'Command Injection Detection', description: 'Detect attempts to inject system commands.' },
      { title: 'Deserialization Monitoring', description: 'Monitor object deserialization for malicious payloads.' },
      { title: 'Execution Environment Checks', description: 'Verify execution contexts are properly sandboxed.' }
    ],
    defenseMechanisms: [
      { title: 'Input Validation', description: 'Strict input validation and whitelisting.' },
      { title: 'Sandboxed Execution', description: 'Run untrusted code in isolated environments.' },
      { title: 'WAF Rules', description: 'Web Application Firewall rules block common RCE patterns.' }
    ],
    impact: {
      attacksBlocked: '275K+',
      responseTime: '20ms',
      successRate: '99.4%'
    },
    technicalDetails: {
      attackVector: 'Deserialization, eval() functions, system commands, file uploads',
      commonTargets: 'Web applications, APIs, file processing systems',
      prevention: 'Input validation, sandboxing, least privilege, secure coding'
    }
  },
  {
    id: '13',
    title: 'Data Exfiltration Prevention',
    shortDescription: 'Monitor and block unauthorized data transfers and sensitive information leaks.',
    fullDescription: 'Data exfiltration can occur through various channels. Our system monitors all outbound data flows, analyzes content for sensitive information, and blocks unauthorized transfers while maintaining business operations.',
    color: '#06b6d4',
    severity: 'High',
    detectionTime: '< 100ms',
    detectionWorkflow: [
      { title: 'Data Classification', description: 'Automatically classify and tag sensitive data.' },
      { title: 'Transfer Monitoring', description: 'Monitor all data transfer channels and methods.' },
      { title: 'Pattern Matching', description: 'Detect sensitive data patterns in outbound communications.' },
      { title: 'Behavioral Analysis', description: 'Identify unusual data access and transfer patterns.' }
    ],
    defenseMechanisms: [
      { title: 'Data Loss Prevention', description: 'DLP policies block unauthorized data transfers.' },
      { title: 'Encryption Enforcement', description: 'Require encryption for sensitive data transfers.' },
      { title: 'Transfer Logging', description: 'Complete audit trail of all data movements.' }
    ],
    impact: {
      attacksBlocked: '510K+',
      responseTime: '85ms',
      successRate: '99.2%'
    },
    technicalDetails: {
      attackVector: 'Email, cloud storage, USB drives, FTP, web uploads',
      commonTargets: 'Customer data, intellectual property, financial records',
      prevention: 'DLP solutions, access controls, encryption, monitoring'
    }
  },
  {
    id: '14',
    title: 'Brute Force Attack Protection',
    shortDescription: 'Intelligent rate limiting and lockout mechanisms to prevent credential attacks.',
    fullDescription: 'Brute force attacks attempt to guess credentials through repeated login attempts. Our system implements adaptive rate limiting, account lockouts, and CAPTCHA challenges while using machine learning to distinguish legitimate users from attackers.',
    color: '#a855f7',
    severity: 'Medium',
    detectionTime: '< 10ms',
    detectionWorkflow: [
      { title: 'Attempt Tracking', description: 'Track failed login attempts per account and IP.' },
      { title: 'Pattern Recognition', description: 'Identify distributed brute force campaigns.' },
      { title: 'Velocity Checks', description: 'Monitor login attempt velocity and patterns.' },
      { title: 'Account Correlation', description: 'Correlate attempts across multiple accounts.' }
    ],
    defenseMechanisms: [
      { title: 'Progressive Delays', description: 'Increase delays between failed attempts.' },
      { title: 'Account Lockout', description: 'Temporary lockout after threshold reached.' },
      { title: 'CAPTCHA Challenges', description: 'Require CAPTCHA for suspicious login patterns.' }
    ],
    impact: {
      attacksBlocked: '3.5M+',
      responseTime: '8ms',
      successRate: '99.6%'
    },
    technicalDetails: {
      attackVector: 'Login pages, API endpoints, SSH services, RDP',
      commonTargets: 'User accounts, admin panels, remote access services',
      prevention: 'Rate limiting, account lockout, MFA, strong passwords'
    }
  },
  {
    id: '15',
    title: 'XML External Entity (XXE) Protection',
    shortDescription: 'Secure XML parsing to prevent XXE injection attacks and data exposure.',
    fullDescription: 'XXE attacks exploit vulnerable XML parsers to access files, perform SSRF, or cause denial of service. Our system implements secure XML parsing configurations and validates all XML input to prevent these attacks.',
    color: '#f59e0b',
    severity: 'High',
    detectionTime: '< 15ms',
    detectionWorkflow: [
      { title: 'XML Input Detection', description: 'Identify all XML input processing points.' },
      { title: 'Entity Detection', description: 'Scan for external entity declarations in XML.' },
      { title: 'Parser Configuration', description: 'Verify secure parser configurations are enforced.' },
      { title: 'Schema Validation', description: 'Validate XML against expected schemas.' }
    ],
    defenseMechanisms: [
      { title: 'Disable External Entities', description: 'Configure parsers to disable external entity processing.' },
      { title: 'Input Filtering', description: 'Filter XML content for malicious entity declarations.' },
      { title: 'Schema Enforcement', description: 'Enforce strict XML schema validation.' }
    ],
    impact: {
      attacksBlocked: '82K+',
      responseTime: '12ms',
      successRate: '99.8%'
    },
    technicalDetails: {
      attackVector: 'XML upload forms, SOAP APIs, XML configuration files',
      commonTargets: 'Web services, SOAP APIs, document processing systems',
      prevention: 'Secure parser configuration, input validation, XML schemas'
    }
  },
  {
    id: '16',
    title: 'Server-Side Request Forgery (SSRF) Prevention',
    shortDescription: 'Validate and restrict server-side requests to prevent SSRF exploitation.',
    fullDescription: 'SSRF attacks trick servers into making requests to unintended locations. Our system validates all server-side requests, implements whitelisting, and monitors for suspicious request patterns to internal resources.',
    color: '#ef4444',
    severity: 'High',
    detectionTime: '< 20ms',
    detectionWorkflow: [
      { title: 'URL Validation', description: 'Validate all URLs before server-side requests.' },
      { title: 'Destination Checking', description: 'Verify request destinations against whitelists.' },
      { title: 'Internal IP Blocking', description: 'Block requests to internal IP ranges.' },
      { title: 'Protocol Restriction', description: 'Restrict allowed protocols for server requests.' }
    ],
    defenseMechanisms: [
      { title: 'URL Whitelisting', description: 'Only allow requests to approved domains.' },
      { title: 'Network Segmentation', description: 'Isolate server resources from user-controlled requests.' },
      { title: 'Response Filtering', description: 'Filter sensitive data from responses.' }
    ],
    impact: {
      attacksBlocked: '145K+',
      responseTime: '18ms',
      successRate: '99.5%'
    },
    technicalDetails: {
      attackVector: 'URL parameters, file uploads, webhook integrations',
      commonTargets: 'Cloud metadata services, internal APIs, admin panels',
      prevention: 'URL validation, whitelisting, network segmentation'
    }
  },
  {
    id: '17',
    title: 'Session Hijacking Prevention',
    shortDescription: 'Secure session management with continuous validation and anomaly detection.',
    fullDescription: 'Session hijacking allows attackers to impersonate legitimate users. Our system implements secure session management, continuous session validation, and anomaly detection to identify and prevent session theft and replay attacks.',
    color: '#10b981',
    severity: 'High',
    detectionTime: '< 30ms',
    detectionWorkflow: [
      { title: 'Session Binding', description: 'Bind sessions to IP, user agent, and device fingerprints.' },
      { title: 'Continuous Validation', description: 'Validate session authenticity on each request.' },
      { title: 'Anomaly Detection', description: 'Detect suspicious changes in session behavior.' },
      { title: 'Concurrent Session Monitoring', description: 'Monitor for impossible travel and concurrent sessions.' }
    ],
    defenseMechanisms: [
      { title: 'Session Rotation', description: 'Regularly rotate session identifiers.' },
      { title: 'Secure Cookies', description: 'Enforce HttpOnly, Secure, and SameSite flags.' },
      { title: 'Session Invalidation', description: 'Immediately invalidate suspicious sessions.' }
    ],
    impact: {
      attacksBlocked: '380K+',
      responseTime: '25ms',
      successRate: '99.4%'
    },
    technicalDetails: {
      attackVector: 'XSS, network sniffing, malware, session fixation',
      commonTargets: 'Web applications, mobile apps, authenticated users',
      prevention: 'Secure cookies, HTTPS, session binding, regular rotation'
    }
  },
  {
    id: '18',
    title: 'DNS Tunneling Detection',
    shortDescription: 'Identify and block data exfiltration and C&C communications via DNS.',
    fullDescription: 'DNS tunneling abuses DNS protocol for data exfiltration and command-and-control communications. Our system analyzes DNS query patterns, payload sizes, and query frequencies to detect tunneling attempts.',
    color: '#3b82f6',
    severity: 'Medium',
    detectionTime: '< 500ms',
    detectionWorkflow: [
      { title: 'Query Analysis', description: 'Analyze DNS query patterns and characteristics.' },
      { title: 'Payload Inspection', description: 'Inspect query payloads for encoded data.' },
      { title: 'Frequency Monitoring', description: 'Monitor query frequencies and burst patterns.' },
      { title: 'Domain Reputation', description: 'Check queried domains against threat intelligence.' }
    ],
    defenseMechanisms: [
      { title: 'Query Blocking', description: 'Block suspicious DNS queries and domains.' },
      { title: 'Rate Limiting', description: 'Limit DNS query rates per client.' },
      { title: 'DNS Filtering', description: 'Filter queries based on reputation and patterns.' }
    ],
    impact: {
      attacksBlocked: '67K+',
      responseTime: '450ms',
      successRate: '98.2%'
    },
    technicalDetails: {
      attackVector: 'DNS queries with encoded data, malware C&C channels',
      commonTargets: 'Corporate networks, endpoints, DNS servers',
      prevention: 'DNS monitoring, query filtering, threat intelligence'
    }
  },
  {
    id: '19',
    title: 'Business Logic Flaw Detection',
    shortDescription: 'Identify and prevent exploitation of application business logic vulnerabilities.',
    fullDescription: 'Business logic flaws occur when application workflows can be manipulated in unintended ways. Our system monitors transaction flows, state changes, and user actions to detect attempts to abuse business processes.',
    color: '#8b5cf6',
    severity: 'High',
    detectionTime: '< 200ms',
    detectionWorkflow: [
      { title: 'Workflow Modeling', description: 'Model expected business process flows and states.' },
      { title: 'State Validation', description: 'Validate state transitions in transactions.' },
      { title: 'Parameter Analysis', description: 'Analyze parameters for manipulation attempts.' },
      { title: 'Abuse Pattern Detection', description: 'Identify patterns of workflow abuse.' }
    ],
    defenseMechanisms: [
      { title: 'State Enforcement', description: 'Enforce valid state transitions server-side.' },
      { title: 'Transaction Validation', description: 'Validate complete transaction integrity.' },
      { title: 'Rate Limiting', description: 'Limit transaction rates to prevent abuse.' }
    ],
    impact: {
      attacksBlocked: '125K+',
      responseTime: '180ms',
      successRate: '97.8%'
    },
    technicalDetails: {
      attackVector: 'Price manipulation, workflow bypass, resource abuse',
      commonTargets: 'E-commerce, banking, payment processing, reservation systems',
      prevention: 'Thorough testing, server-side validation, transaction monitoring'
    }
  },
  {
    id: '20',
    title: 'Container Escape Prevention',
    shortDescription: 'Monitor and prevent container breakout attempts in containerized environments.',
    fullDescription: 'Container escape vulnerabilities allow attackers to break out of container isolation. Our system monitors kernel calls, capability usage, and container runtime behaviors to detect and prevent escape attempts.',
    color: '#06b6d4',
    severity: 'Critical',
    detectionTime: '< 50ms',
    detectionWorkflow: [
      { title: 'Syscall Monitoring', description: 'Monitor system calls from containers for anomalies.' },
      { title: 'Capability Tracking', description: 'Track container capabilities and privilege usage.' },
      { title: 'Resource Access Monitoring', description: 'Monitor attempts to access host resources.' },
      { title: 'Runtime Behavior Analysis', description: 'Analyze container runtime for escape patterns.' }
    ],
    defenseMechanisms: [
      { title: 'Least Privilege', description: 'Enforce minimal container capabilities.' },
      { title: 'Syscall Filtering', description: 'Use seccomp profiles to limit syscalls.' },
      { title: 'Runtime Protection', description: 'Runtime security policies block escape attempts.' }
    ],
    impact: {
      attacksBlocked: '15K+',
      responseTime: '45ms',
      successRate: '99.1%'
    },
    technicalDetails: {
      attackVector: 'Kernel exploits, misconfigurations, privileged containers',
      commonTargets: 'Docker, Kubernetes, container orchestration platforms',
      prevention: 'Security policies, least privilege, regular updates, runtime protection'
    }
  }
]

const vulnerability = computed(() => {
  const id = route.params.id
  return vulnerabilities.find(v => v.id === id)
})

onMounted(() => {
  if (!vulnerability.value) {
    router.push('/')
  }
})
</script>

<style scoped>
.vulnerability-detail-page {
  min-height: 100vh;
  padding: 6rem 0 4rem;
  background: rgba(248, 250, 252, 0.5);
}

.dark .vulnerability-detail-page {
  background: rgba(0, 0, 0, 0.8);
}

.container {
  @apply max-w-5xl mx-auto px-6;
}

/* Back Button */
.back-button {
  @apply flex items-center gap-2 mb-8 px-4 py-2 rounded-lg transition-all duration-300;
  background: rgba(103, 62, 230, 0.1);
  color: #673ee6;
  border: 1px solid rgba(103, 62, 230, 0.2);
}

.back-button:hover {
  background: rgba(103, 62, 230, 0.2);
  transform: translateX(-5px);
}

/* Vulnerability Header */
.vulnerability-header {
  @apply text-center mb-12;
}

.vulnerability-badge {
  @apply inline-block px-4 py-2 rounded-full text-white text-sm font-semibold mb-4;
}

.vulnerability-title {
  @apply text-4xl md:text-5xl font-bold mb-6;
  color: #1a202c;
}

.dark .vulnerability-title {
  color: #f7fafc;
}

.vulnerability-meta {
  @apply flex flex-wrap justify-center gap-6 text-gray-600;
}

.dark .vulnerability-meta {
  @apply text-gray-300;
}

.meta-item {
  @apply flex items-center gap-2;
}

/* Content Sections */
.vulnerability-content {
  @apply p-8 rounded-xl mb-8;
}

.content-section {
  @apply mb-12 last:mb-0;
}

.section-heading {
  @apply text-2xl font-bold mb-6;
  color: #673ee6;
}

.section-text {
  @apply text-gray-700 leading-relaxed text-lg;
}

.dark .section-text {
  @apply text-gray-300;
}

/* Workflow Steps */
.workflow-steps {
  @apply space-y-6;
}

.workflow-step {
  @apply flex gap-4 p-6 rounded-lg;
  background: rgba(103, 62, 230, 0.05);
  border-left: 3px solid #673ee6;
}

.dark .workflow-step {
  background: rgba(103, 62, 230, 0.1);
}

.step-number {
  @apply flex-shrink-0 w-10 h-10 rounded-full flex items-center justify-center font-bold text-white;
  background: linear-gradient(135deg, #673ee6, #00b090);
}

.step-content {
  @apply flex-1;
}

.step-title {
  @apply text-lg font-bold mb-2;
  color: #1a202c;
}

.dark .step-title {
  color: #f7fafc;
}

.step-description {
  @apply text-gray-600;
}

.dark .step-description {
  @apply text-gray-300;
}

/* Defense Grid */
.defense-grid {
  @apply grid grid-cols-1 md:grid-cols-3 gap-6;
}

.defense-card {
  @apply p-6 rounded-lg transition-all duration-300 hover:scale-105;
  background: rgba(0, 176, 144, 0.05);
  border: 1px solid rgba(0, 176, 144, 0.2);
}

.dark .defense-card {
  background: rgba(0, 176, 144, 0.1);
}

.defense-icon {
  @apply w-12 h-12 rounded-lg flex items-center justify-center mb-4;
  background: linear-gradient(135deg, #00b090, #673ee6);
  color: white;
}

.defense-title {
  @apply text-lg font-bold mb-2;
  color: #1a202c;
}

.dark .defense-title {
  color: #f7fafc;
}

.defense-description {
  @apply text-sm text-gray-600;
}

.dark .defense-description {
  @apply text-gray-300;
}

/* Impact Stats */
.impact-stats {
  @apply grid grid-cols-1 md:grid-cols-3 gap-6;
}

.impact-stat {
  @apply text-center p-6 rounded-lg;
  background: rgba(103, 62, 230, 0.05);
  border: 2px solid rgba(103, 62, 230, 0.2);
}

.dark .impact-stat {
  background: rgba(103, 62, 230, 0.1);
}

.stat-value {
  @apply text-4xl font-bold mb-2;
  color: #673ee6;
}

.stat-label {
  @apply text-gray-600 font-medium;
}

.dark .stat-label {
  @apply text-gray-300;
}

/* Technical Details */
.technical-details {
  @apply space-y-4;
}

.detail-item {
  @apply p-4 rounded-lg;
  background: rgba(0, 0, 0, 0.02);
  border-left: 3px solid #00b090;
}

.dark .detail-item {
  background: rgba(255, 255, 255, 0.05);
}

.detail-item strong {
  color: #00b090;
  margin-right: 0.5rem;
}

/* CTA Section */
.cta-section {
  @apply text-center p-12 rounded-xl;
}

.cta-title {
  @apply text-3xl font-bold mb-4;
  color: #1a202c;
}

.dark .cta-title {
  color: #f7fafc;
}

.cta-description {
  @apply text-lg text-gray-600 mb-8 max-w-2xl mx-auto;
}

.dark .cta-description {
  @apply text-gray-300;
}

/* Finding Steps */
.steps-container {
  @apply space-y-6;
}

.finding-step {
  @apply p-6 rounded-lg;
  background: rgba(103, 62, 230, 0.05);
  border-left: 4px solid #673ee6;
}

.step-header {
  @apply flex items-center gap-4 mb-3;
}

.step-badge {
  @apply px-3 py-1 rounded-full text-sm font-bold;
  background: linear-gradient(135deg, #673ee6, #00b090);
  color: white;
}

.finding-step-title {
  @apply text-xl font-bold;
  color: #1a202c;
}

.dark .finding-step-title {
  color: #f7fafc;
}

.finding-step-description {
  @apply text-gray-600 mb-3;
}

.dark .finding-step-description {
  @apply text-gray-300;
}

.command-box {
  @apply mt-4 p-4 rounded-lg;
  background: rgba(0, 0, 0, 0.8);
  border: 1px solid rgba(0, 176, 144, 0.3);
}

.command-label {
  @apply text-sm font-semibold mb-2;
  color: #00b090;
}

.command-text {
  @apply block text-sm font-mono;
  color: #10b981;
}

/* Code Examples */
.code-section {
  @apply mb-8;
}

.code-section-title {
  @apply text-xl font-bold mb-4;
  color: #673ee6;
}

.code-block {
  @apply rounded-lg overflow-hidden;
  border: 2px solid;
}

.code-block.vulnerable {
  border-color: #ef4444;
  background: rgba(239, 68, 68, 0.05);
}

.code-block.secure {
  border-color: #10b981;
  background: rgba(16, 185, 129, 0.05);
}

.code-block.attack {
  border-color: #f97316;
  background: rgba(249, 115, 22, 0.05);
}

.code-header {
  @apply flex justify-between items-center px-4 py-3;
  background: rgba(0, 0, 0, 0.8);
  border-bottom: 1px solid rgba(255, 255, 255, 0.1);
}

.code-language {
  @apply text-sm font-semibold;
  color: #a0a0a0;
}

.code-badge {
  @apply px-3 py-1 rounded-full text-xs font-bold;
}

.code-badge.danger {
  background: #ef4444;
  color: white;
}

.code-badge.safe {
  background: #10b981;
  color: white;
}

.code-badge.attack {
  background: #f97316;
  color: white;
}

.code-content {
  @apply p-6 overflow-x-auto;
  background: rgba(0, 0, 0, 0.9);
}

.code-content code {
  @apply font-mono text-sm leading-relaxed;
  color: #10b981;
  display: block;
  white-space: pre;
}

/* Responsive */
@media (max-width: 768px) {
  .vulnerability-title {
    @apply text-3xl;
  }
  
  .vulnerability-content {
    @apply p-6;
  }
  
  .defense-grid,
  .impact-stats {
    @apply grid-cols-1;
  }
  
  .code-content {
    @apply p-4 text-xs;
  }
}
</style>
